<% if user_signed_in? %>
<%= render template: "components/navbarLoggedIn"%>
<% else %>
<%= render template: "components/navbarNewUser"%>
<% end %>

<% 
def showStatus(task)
	if task.confirmed == false && task.completed == false && task.incomplete==false
		return 'circles/open-circle.png'
	elsif task.confirmed == true && task.completed == false && task.incomplete==false
		return 'circles/closed-circle.png'
	elsif task.confirmed == true && task.completed == true && task.incomplete==false
		return 'circles/smily-circle.png'
	else
		return 'circles/closed-circle-red.png'
	end
end

def showNego(status)
	if status == true
		return '(Price Negotiable)'
	end
end
%>

<!-- SHhow bid price. Show who posted. Allow taskee to bid. Update database accordingly -->
<div>
<div class="mainCenter">

	<h1 class="logoFont">Here are the available tasks.</h1>

	<%= link_to 'New task', new_task_path %>

	<div>
		<% @tasks.each do |task| %>
			<div class="card d-inline-block align-top m-3" style="width: 20rem;">
				<div class="card-body">
					<img 
						src="<%= image_url showStatus(task) %>" 
						class="position-relative float-right"
					/>
					<h5 class="card-title">
						<%= task.task_name %>
					</h5>
					<h5 class="card-text">
						<%= number_to_currency(task.price) %>
						<%= showNego(task.negotiable) %>
					</h5>
					<h5 class="card-title">Postal Code: <%= task.location %></h5>
					<p class="card-text">Start Time: <%= task.start_time %></p>
					<h6 class="card-subtitle mb-2 text-muted innerDesc"> <%= task.task_description %></h6>
					<p class="card-text">
						Posted by: <strong><%= task.user.username %></strong>
					</p>
					<p class="card-text">
						On: <%= task.created_at %>
					</p>
					<%= form_with model: @taskee do |form| %>
						<input type="hidden" name="taskee[task_id]" id="taskee_task_id" value=<%= task.id %>>
						<input placeholder="Minimum: $0" class="form-control" type="number" name="taskee[bid]" id="taskee_bid">
						<input type="submit" name="commit" value="Bid for Task" data-disable-with="Save Task" class="btn btn-success logoFont">
					<% end %>
				</div>
			</div>
	  <% end %>
	</div>
	<br/>
</div>
</div>


<p>
	<img src="<%= image_url 'circles/open-circle.png' %>"/>
	This icon means the task is open for taskees.
</p>
<p>
	<img src="<%= image_url 'circles/closed-circle.png' %>"/>
	This icon means the tasker has selected the taskee.</p>
<p>
	<img src="<%= image_url 'circles/smiley-circle.png' %>"/>
	This icon means that the job is done.
</p>
<p>
	<img src="<%= image_url 'circles/closed-circle-red.png' %>"/>
	This icon means that the job is incomplete, for some reason.
</p>